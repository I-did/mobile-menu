(function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?module.exports=a():window.MobileMenu=a()})(function(){return MobileMenu=function(){return function(a){let b,c,d,e=this;return e.options=b=a,e.defaults=c={menuClass:"active",overlay:!1,overlayClass:"active",openBtnClass:"active",toLeft:!1,toRight:!1,toBottom:!1,toTop:!1,fade:!1,swipe:!0,escToClose:!0,clickOverlayToClose:!0,swipeThreshold:.35,pageScroll:!1,animation:"",fixHeader:"",fixHeaderClass:"fixed",transition:{menu:{property:"transform",from:"",to:"translate3d(0px, 0px, 0px)",timigFunction:"ease",delay:0,duration:.5},overlay:{property:"opacity",from:0,to:1,timigFunction:"ease",delay:0,duration:.5}}},e.initials=d={$menu:null,$openBtn:null,$closeBtn:null,$fakeScrollbar:null,$fixHeader:null,$headerClone:null,$headerParent:null,$overlay:null,fixHeaderThreshold:0,swipeObject:{isSwipe:!1,isScroll:!1,posInitX:0,posX1:0,posX2:0,posInitY:0,posY1:0,posY2:0,posFinal:0}},e.assign(c,b),e.assign(d,e),e.closeMenuHandler={handleEvent:e.closeMenu,ctx:e},e.swipeStartHandler={handleEvent:e.swipeStart,ctx:e},e.swipeActionHandler={handleEvent:e.swipeAction,ctx:e},e.swipeEndHandler={handleEvent:e.swipeEnd,ctx:e},e.fixHeaderHandler={handleEvent:e.fixHeader,ctx:e},e.unfixHeaderHandler={handleEvent:e.unfixHeader,ctx:e},e.closed=!0,e.opened=!1,e.init(),e.$menu}}(),MobileMenu.prototype.assign=function(a,b){for(let c in a)void 0===b[c]?b[c]=a[c]:"object"==typeof b[c]&&this.assign(a[c],b[c])},MobileMenu.prototype.init=function(){let a=this,b=document.body,c=a.options,d=c.transition.menu;a.$menu=document.querySelector(c.menu),a.$openBtn=document.querySelectorAll(c.openBtn),a.$closeBtn=document.querySelectorAll(c.closeBtn),c.overlay&&(a.$overlay=document.querySelector(c.overlay)),c.fixHeader&&(a.$fixHeader=document.querySelector(c.fixHeader));let e=a.$menu,f=a.$overlay,g=a.$fixHeader;if(!c.animation.menu)if(c.fade)d.property="opacity",d.from=0,d.to=1;else{c.toRight||c.toLeft||c.toTop||c.toBottom||(c.toLeft=!0);let a=c.toRight?"-100%":c.toLeft?"100%":"0px",b=c.toBottom?"-100%":c.toTop?"100%":"0px";d.from="translate3d("+a+", "+b+", 0px)"}e.openMenu=a.openMenu,e.closeMenu=a.closeMenu,e.ctx=a,f&&a.initAnimEvents("overlay"),c.pageScroll||(a.$fakeScrollbar=document.querySelector("#fake-scrollbar"),!a.$fakeScrollbar&&(a.$fakeScrollbar=document.createElement("div"),a.$fakeScrollbar.id="fake-scrollbar",a.$fakeScrollbar.style.cssText="display:none;pointer-events:none;position:fixed;top:0;left:0;width:100%;height:100%;overflow-y:scroll;z-index:9999;",b.appendChild(a.$fakeScrollbar))),g&&(a.$headerClone=g.cloneNode(!0),a.$headerParent=g.parentElement,a.fixHeaderThreshold=g.getBoundingClientRect().bottom+pageYOffset,a.$headerClone.style.opacity=0,a.$headerClone.style.pointerEvents="none",window.addEventListener("scroll",a.fixHeaderHandler),new MutationObserver(function(a){for(let b,d=0;d<a.length;d++)if(b=a[d],"attributes"===b.type){let a=document.querySelector(c.fixHeader+"."+c.fixHeaderClass);if(b.target.style.paddingRight){a&&(a.style.width="calc(100% - "+b.target.style.paddingRight+")");break}else a&&(a.style.width="")}}).observe(b,{attributes:!0}),a.fixHeader()),a.dispatchEvent(e,"menuinit"),a.initEvents("add"),a.initAnimEvents("menu")},MobileMenu.prototype.initEvents=function(a){let b=this,c=b.$menu,d=b.$overlay,e=b.options,f=b.$openBtn,g=b.$closeBtn,h=function(a,c){for(let d=0;d<a.length;d++)a[d]&&(a[d].addEventListener("click",c),a[d].ctx=b)},i=function(a,b){for(let c=0;c<a.length;c++)a[c]&&a[c].removeEventListener("click",b)};"add"===a?(h(f,b.openMenu),h(g,b.closeMenu)):"remove"==a&&(i(f,b.openMenu),i(g,b.closeMenu)),e.swipe&&!e.fade&&(c.addEventListener("touchstart",b.swipeStartHandler),c.addEventListener("touchend",b.swipeEndHandler)),d&&(d.ctx=b,e.clickOverlayToClose&&d.addEventListener("click",b.closeMenu)),e.escToClose&&document.addEventListener("keyup",b.closeMenuHandler)},MobileMenu.prototype.dispatchEvent=function(a,b){if("function"==typeof window.CustomEvent){let c=new CustomEvent(b);a.dispatchEvent(c)}},MobileMenu.prototype.getTransform=function(){let a=this.$menu.style.transform.match(/\-?\d+\.?\d*/g);return{x:+a[0],y:+a[1]}},MobileMenu.prototype.initAnimEvents=function(a){let b=this,c=b.$menu,d=b["$"+a];if(d){let e=b.options.animation[a],f=b.options.transition[a],g=function(){if(f?(d.style[f.property]="",d.style.transition=""):d.style.animation="",d.classList.remove("active"),d===c);d.style.pointerEvents="",b.options.pageScroll||(document.body.style.overflow="",document.body.style.paddingRight="",b.$fakeScrollbar.style.display="none"),b.closed=!0,b.dispatchEvent(d,a+"close")},h=function(){b.dispatchEvent(d,a+"open"),d===c&&(b.opened=!0,c.style.pointerEvents="auto")};e?d.addEventListener("animationend",function(){event.animationName===e.open.name?h():g()}):f&&d.addEventListener("transitionend",function(){d.style[f.property]==f.to?h():g()})}},MobileMenu.prototype.playAnimation=function(a,b){let c=this,d=c["$"+a],e=c.options.animation[a]&&c.options.animation[a][b],f=c.options.transition[a];if(setTransition=function(a){a=a||"to";let b=f.property,c=f.timigFunction,e=f.delay+"s",g=f.duration+"s";d.style.transition||(d.style.transition=b+" "+c+" "+g+" "+e),d.style[b]=f[a]},e){let a=e.name,b=(e.duration||.5)+"s",c=(e.delay||0)+"s",f=e.timigFunction||"ease";d.style.animation=a+" "+f+" "+b+" "+c}else f&&("open"===b?setTimeout(setTransition,25):setTransition("from"))},MobileMenu.prototype.openMenu=function(){let a=this.ctx||this,b=document.body,c=a.options,d=a.$menu,e=a.$overlay,f=c.transition.menu,g=c.animation.menu,h=c.transition.overlay,i=c.animation.overlay,j=a.$fakeScrollbar,k=a.$openBtn;if(a.closed){if(a.closed=!1,a.dispatchEvent(d,"menubeforeopen"),g||(c.fade?d.style.opacity=0:d.style.transform=f.from,d.style.transition=f.property+" "+f.duration+"s "+f.delay+"s "+f.timigFunction),!i&&e&&(a.$overlay.style[h.property]=h.from),k.length)for(let a=0;a<k.length;a++)k[a].classList.add(c.openBtnClass);c.pageScroll||(j.style.display="block",b.style.paddingRight=j.offsetWidth-j.clientWidth+"px",b.style.overflow="hidden"),d.classList.add(c.menuClass),a.playAnimation("menu","open"),e&&(e.classList.add(c.overlayClass),a.playAnimation("overlay","open")),d.caller=this,d.scrollTop=0,d.style.pointerEvents="none"}},MobileMenu.prototype.closeMenu=function(){let a=this.ctx||this,b=a.options,c=a.$menu,d=a.$overlay,e=a.$openBtn;if(!(event&&"keyup"===event.type&&27!==event.keyCode)&&a.opened){if(a.opened=!1,a.dispatchEvent(c,"menubeforeclose"),e.length)for(let a=0;a<e.length;a++)e[a].classList.remove(b.openBtnClass);c.style.pointerEvents="none",a.playAnimation("menu","close"),d&&a.playAnimation("overlay","close")}},MobileMenu.prototype.swipeStart=function(){let a=this.ctx||this,b=a.$menu,c=a.swipeObject,d=event.touches[0]||window.event.touches[0];c.isSwipe=c.isScroll=!1,c.posInitX=c.posX1=+d.clientX.toFixed(),c.posInitY=c.posY1=+d.clientY.toFixed(),b.addEventListener("touchmove",a.swipeActionHandler),b.style.transition=""},MobileMenu.prototype.swipeAction=function(){let a=this.ctx||this,b=a.$menu,c=a.options,d=a.swipeObject,e=event.touches[0]||window.event.touches[0];d.posY2=d.posY1-e.clientY.toFixed(),d.posY1=e.clientY.toFixed(),d.posX2=d.posX1-e.clientX.toFixed(),d.posX1=e.clientX.toFixed(),d.isSwipe||d.isScroll||(7<Math.abs(d.posY2)?d.isScroll=!0:5>Math.abs(d.posY2)&&(d.isSwipe=!0));let f=a.getTransform();d.isSwipe&&c.toLeft&&d.posX1>d.posInitX||c.toRight&&d.posX1<d.posInitX?b.style.transform="translate("+(f.x-d.posX2)+"px, 0px)":(d.isScroll&&c.toBottom&&b.offsetHeight+b.scrollTop+1>=b.scrollHeight&&d.posY1<d.posInitY||c.toTop&&0===b.scrollTop&&d.posY1>d.posInitY)&&(event.preventDefault(),b.style.transform="translate(0px, "+(f.y-d.posY2)+"px)")},MobileMenu.prototype.swipeEnd=function(){let a=this.ctx||this,b=a.$menu,c=a.swipeObject,d=a.options;c.posFinal=d.toLeft||d.toRight?a.getTransform().x:a.getTransform().y;let e=b.offsetWidth*d.swipeThreshold;Math.abs(c.posFinal)>=e?a.closeMenu():"translate(0px, 0px)"!==b.style.transform&&(b.style.transform="translate(0px, 0px)",b.style.transition="transform "+d.transition.menu.duration+"s",b.style.pointerEvents="none")},MobileMenu.prototype.fixHeader=function(){let a=this.ctx||this;pageYOffset>a.fixHeaderThreshold&&!a.$menu.classList.contains(a.options.menuClass)&&(a.$headerParent.appendChild(a.$headerParent.replaceChild(a.$headerClone,a.$fixHeader)),a.$fixHeader.classList.add("fixed"),window.removeEventListener("scroll",a.fixHeaderHandler),window.addEventListener("scroll",a.unfixHeaderHandler),a.dispatchEvent(a.$fixHeader,"headerfixed"))},MobileMenu.prototype.unfixHeader=function(){let a=this.ctx||this;pageYOffset<=a.fixHeaderThreshold&&(a.$headerParent.replaceChild(a.$fixHeader,a.$headerClone),a.$fixHeader.classList.remove("fixed"),window.removeEventListener("scroll",a.unfixHeaderHandler),window.addEventListener("scroll",a.fixHeaderHandler),a.dispatchEvent(a.$fixHeader,"headerunfixed"))},MobileMenu});