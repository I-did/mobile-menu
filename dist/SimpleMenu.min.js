(function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?module.exports=a():window.SimpleMenu=a()})(function(){function a(a,b,c){var d;return function(){var e=this,f=arguments,g=c&&!d;clearTimeout(d),d=setTimeout(function(){d=null,c||a.apply(e,f)},b),g&&a.apply(e,f)}}let b,c,d,e=document.head,f=document.body;return class{constructor(c){for(let a in b=this,b.defaults={menu:{selector:"",class:"active",animationDuration:.5,animationTimigFunc:"ease"},openBtn:{selector:"",class:"",toggleClass:"",addClass:"animationstart",removeClass:"animationstart"},closeBtn:{selector:"",class:"",toggleClass:"",addClass:"animationstart",removeClass:"animationstart"},overlay:{selector:"",class:"active",bgc:"rgba(0,0,0,.5)",zi:"10",css:"",animationDuration:.5,animationTimigFunc:"ease"},desktop:!1,mediaQuery:"",toTop:!1,toBottom:!1,toLeft:!1,toRight:!1,fade:!1,swipe:!0,swipeThreshold:.3,pageScrolling:!1,scrollingPxs:50,overlayClick:!0,esc:!0},d=b.options=c||{},b.defaults)if(void 0===d[a])d[a]=b.defaults[a];else if("string"!=typeof d[a]&&!1!==d[a])for(let c in b.defaults[a])void 0===d[a][c]&&(d[a][c]=b.defaults[a][c]);else"string"==typeof d[a]&&"string"!=typeof b.defaults[a]&&(b.defaults[a].selector=d[a],d[a]=b.defaults[a]);""!==d.mediaQuery&&(d.desktop=!0),delete b.defaults,b.checkMedia(),window.addEventListener("resize",a(b.checkMedia,100))}checkMedia(a){d.desktop?""===d.mediaQuery?!a&&b.buldMenu():window.matchMedia(d.mediaQuery).matches?a&&"resize"===a.type?c?!c.actived&&b.restoreEvents():b.buldMenu():b.buldMenu():a&&"resize"===a.type&&b.menu&&c.actived&&b.destroyEvents():/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?a&&"resize"===a.type?c?!c.actived&&b.restoreEvents():b.buldMenu():b.buldMenu():a&&"resize"===a.type&&b.menu&&c.actived&&b.destroyEvents()}buldMenu(){b.init(),b.initOverlay(),b.initMenu()}initOverlay(){b.overlay=function(){let a,c=d.overlay;return!1!==c&&(""===c.selector?(a=document.createElement("div"),a.style.cssText=`position:fixed;top:0;left:0;width:100%;height:100%;background:${c.bgc};z-index:${c.zi};${c.css}`,b.buildAnimation(c,["fi","fo"],["opacity:0","opacity:1"]),c.open=function(){f.appendChild(this.tag),b.setAnimationFor(this,this.animationIn)},c.close=function(){b.setAnimationFor(this,this.animationOut),a.addEventListener("animationend",()=>{f.removeChild(this.tag)},{once:!0})}):(a=document.querySelector(c.selector||c),c.open=function(){this.tag.classList.add(c.class)},c.close=function(){this.tag.classList.remove(c.class)}),c.tag=a,a?c:console.error("You'r overlay is not found!"))}()}initMenu(){b.menu=function(){function a(){for(let a of arguments)a.class&&(a.toggleClass?c.tag.addEventListener(a.toggleClass,()=>a.tag.classList.toggle(a.class)):(c.tag.addEventListener("animationstart"===a.addClass?"beforeopen":"open",()=>a.tag.classList.add(a.class)),c.tag.addEventListener("animationstart"===a.removeClass?"beforeclose":"close",()=>a.tag.classList.remove(a.class))))}let e=b.findElement(d.menu,"Menu");if(c=e,b.tag=c.tag,a(b.openBtn,b.closeBtn),b.open=c.open=function(){c.pageYscroll=pageYOffset,c.tag.classList.add(c.class),c.open.container(),b.setAnimationFor(c,c.animationIn),b.openBtn.tag.removeEventListener("click",c.open),b.overlay&&b.overlay.open(),-1===navigator.userAgent.search(/edge/i)&&c.tag.scrollHeight>c.tag.offsetHeight&&0<c.tag.scrollTop&&c.tag.scrollTo(0,0),c.tag.dispatchEvent(new Event("beforeopen")),c.tag.addEventListener("animationend",function(){c.width||(c.width=c.tag.offsetWidth),c.tag.dispatchEvent(new Event("open")),c.opened=!0,window.addEventListener("resize",c.close,{once:!0}),d.pageScrolling||window.addEventListener("scroll",c.close),d.esc&&document.addEventListener("keyup",c.close),b.closeBtn.tag.addEventListener("click",c.close),b.overlay&&d.overlayClick&&b.overlay.tag.addEventListener("click",c.close)},{once:!0})},b.close=c.close=function(){event&&"keyup"===event.type&&27!==event.keyCode||event&&"scroll"===event.type&&Math.abs(c.pageYscroll-pageYOffset)<d.scrollingPxs||(b.setAnimationFor(c,c.animationOut),b.closeBtn.tag.removeEventListener("click",c.close),b.overlay&&d.overlayClick&&b.overlay.tag.removeEventListener("click",c.close),c.tag.removeEventListener("touchmove",c.swipeMove),!d.pageScrolling&&window.removeEventListener("scroll",c.close),b.overlay&&b.overlay.close(),d.esc&&document.removeEventListener("keyup",c.close),window.removeEventListener("resize",c.close),c.tag.dispatchEvent(new Event("beforeclose")),c.tag.addEventListener("animationend",function(){c.tag.classList.remove(c.class),c.open.container(),c.tag.dispatchEvent(new Event("close")),c.opened=!1,c.tag.style.transform="",c.tag.style.willChange="",b.openBtn.tag.addEventListener("click",c.open)},{once:!0}))},c.getTransform=function(){return+c.tag.style.transform.replace(/[^0-9-.]*/g,"")},!d.fade){let a,b,e,f,g,h,i,j,k;c.swipeStart=function(){c.tag.style.willChange="transform";let d=event.touches[0]||window.event.touches[0];i=e=+d.clientX.toFixed(),k=g=+d.clientY.toFixed(),c.tag.addEventListener("touchmove",c.swipeMove),c.tag.addEventListener("touchend",()=>a=b=!1,{once:!0})},c.swipeMove=function(){let j=event.touches[0]||window.event.touches[0];h=g-j.clientY.toFixed(),g=j.clientY.toFixed(),f=e-j.clientX.toFixed(),e=j.clientX.toFixed(),a||b||(9<Math.abs(h)?(console.log("scroll"),b=!0):5>Math.abs(h)&&(console.log("swipe"),a=!0)),a&&d.toLeft&&e>i||d.toRight&&e<i?(c.tag.addEventListener("touchend",c.swipeEnd),c.tag.style.transform=`translateX(${c.getTransform()-f}px)`):(b&&d.toBottom&&c.tag.offsetHeight+c.tag.scrollTop>=c.tag.scrollHeight&&g<k||d.toTop&&0===c.tag.scrollTop&&g>k)&&(event.preventDefault(),c.tag.addEventListener("touchend",c.swipeEnd),c.tag.style.transform=`translateY(${c.getTransform()-h}px)`)},c.swipeEnd=function(){c.tag.removeEventListener("touchend",c.swipeEnd),j=c.getTransform();let a=c.width*d.swipeThreshold;Math.abs(j)>=a?c.close():(c.tag.style.transform="translate(0)",c.tag.style.transition=`transform ${c.animationDuration}s`,c.tag.addEventListener("transitionend",()=>c.tag.style.transition="",{once:!0}))},d.swipe&&c.tag.addEventListener("touchstart",c.swipeStart)}if(!d.fade){let a=c.container=document.createElement("div");if(a.style.cssText="position:absolute;overflow:hidden;",a.style.top=getComputedStyle(c.tag).top,a.style.bottom=getComputedStyle(c.tag).bottom,a.style.zIndex=getComputedStyle(c.tag).zIndex,c.contained=!1,c.tag.style.top=0,c.tag.style.bottom="auto",c.parent=c.tag.parentElement,c.open.container=function(){c.contained?(c.parent.appendChild(c.tag),c.parent.removeChild(a),c.contained=!1):(a.style.height=`${c.tag.offsetHeight}px`,a.style.width=`${c.tag.offsetWidth}px`,a.style.left=getComputedStyle(c.tag).left,a.style.right=getComputedStyle(c.tag).right,c.parent.appendChild(a),a.appendChild(c.tag),c.contained=!0)},!d.toTop&&!d.toBottom&&!d.toLeft&&!d.toRight){let a=window.screen.width,c={left:+b.openBtn.tag.getBoundingClientRect().left.toFixed(),right:+(a-b.openBtn.tag.getBoundingClientRect().right).toFixed()};c.left>c.right?d.toLeft=!0:d.toRight=!0}d.toLeft?(b.buildAnimation(c,["fr","tr"],["translateX(100%)","translateX(0%)"]),c.tag.style.right=0,c.tag.style.left="auto"):d.toRight?(b.buildAnimation(c,["fl","tl"],["translateX(-100%)","translateX(0%)"]),c.tag.style.left=0,c.tag.style.right="auto"):d.toBottom?(c.tag.style.top=0,c.tag.style.bottom="auto",b.buildAnimation(c,["ft","tt"],["translateY(-100%)","translateY(0%)"])):d.toTop&&(b.buildAnimation(c,["fb","tb"],["translateY(100%)","translateY(0%)"]),c.tag.style.bottom=0,c.tag.style.top="auto")}else{if(!d.menu.animationIn&&!d.menu.animationOut)b.buildAnimation(c,["fi","fo"],["opacity:0","opacity:1"]);else if(!d.menu.animationIn||!d.menu.animationOut)return void console.error("Add another animaion!");c.open.container=()=>!1}return b.restoreEvents(),e}()}destroyEvents(){b.openBtn.tag.removeEventListener("click",c.open),b.closeBtn.tag.removeEventListener("click",c.close),c.actived=!1}restoreEvents(){b.openBtn.tag.addEventListener("click",c.open),b.closeBtn.tag.addEventListener("click",c.close),c.actived=!0}init(){b.openBtn=function(){let a=b.findElement(d.openBtn,"Open button(s)");return a}(),b.closeBtn=b.findElement(d.closeBtn,"Close button(s)")}findElement(a,b){let c;return""===a.selector?console.error(`${b} selector is empty!`):c=document.querySelector(a.selector),a.tag=c,c?a:console.error(`${b} is not found!`)}buildAnimation(a,b,c){let d=["animationIn","animationOut"];for(let e=0;e<b.length;e++)c[e]=c[e].replace(/(translate(.*))/,"transform:$1"),a[d[e]]={name:b[e],key:`@keyframes ${b[e]}{from{${c[e]}}to{${c[1==e?0:1]}}}`}}setAnimationFor(a,b){let d;b.key&&(d=document.createElement("style"),d.textContent=b===c.animationOut?b.key.replace(/\(.*?\)/,`(${c.getTransform()})`):b.key,e.appendChild(d)),a.tag.style.animation=`${b.name} ${a.animationDuration}s ${a.animationTimigFunc}`,a.tag.addEventListener("animationend",()=>{a.tag.style.animation="",b.key&&e.removeChild(d)},{once:!0})}}});